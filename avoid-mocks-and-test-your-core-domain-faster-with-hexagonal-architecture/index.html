<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Avoid mocks and test your core domain faster with Hexagonal Architecture | Philippe Bourgau’s XP Coaching Blog</title>
<meta name="description" content="An explanation of why large systems tend to favor the emergence of mocks and what Hexagonal Architecture can do against that. Illustrated with Ruby on Rails code examples.">


  <meta name="author" content="Philippe Bourgau">
  
  <meta property="article:author" content="Philippe Bourgau">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Philippe Bourgau's XP Coaching Blog">
<meta property="og:title" content="Avoid mocks and test your core domain faster with Hexagonal Architecture">
<meta property="og:url" content="https://philippe.bourgau.net/avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/">


  <meta property="og:description" content="An explanation of why large systems tend to favor the emergence of mocks and what Hexagonal Architecture can do against that. Illustrated with Ruby on Rails code examples.">



  <meta property="og:image" content="https://philippe.bourgau.net/imgs/2018-05-24-avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/hexagonal-building.jpg">



  <meta name="twitter:site" content="@pbourgau">
  <meta name="twitter:title" content="Avoid mocks and test your core domain faster with Hexagonal Architecture">
  <meta name="twitter:description" content="An explanation of why large systems tend to favor the emergence of mocks and what Hexagonal Architecture can do against that. Illustrated with Ruby on Rails code examples.">
  <meta name="twitter:url" content="https://philippe.bourgau.net/avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://philippe.bourgau.net/imgs/2018-05-24-avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/hexagonal-building.jpg">
  

  



  <meta property="article:published_time" content="2018-05-24T06:43:00+00:00">





  

  


<link rel="canonical" href="https://philippe.bourgau.net/avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Philippe Bourgau",
      "url": "https://philippe.bourgau.net/",
      "sameAs": ["https://twitter.com/pbourgau","https://www.linkedin.com/in/philippe-bourgau-607a928/","https://github.com/philou","https://www.youtube.com/channel/UCq6uOPvSmpQeVrLRCQOQ8KQ"]
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Philippe Bourgau's XP Coaching Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single-mailing-list">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Philippe Bourgau's XP Coaching Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about-me/">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/services/">Services</a>
            </li><li class="masthead__menu-item">
              <a href="/speaking/">Speaking</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/archives/">Archives</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="http://www.gravatar.com/avatar/686399bd630ecc9381e4dfec8720816e?s=260" alt="Philippe Bourgau" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Philippe Bourgau</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Software Development Coach</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Paris, France</span>
        </li>
      

      
        
          
        
          
            <li><a href="/about-me" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/pbourgau" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/philou" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/philippe-bourgau-607a928" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
        
          
            <li><a href="https://www.youtube.com/channel/UCq6uOPvSmpQeVrLRCQOQ8KQ" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="https://www.eventstormingjournal.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-sticky-note" aria-hidden="true"></i><span class="label">Event Storming Journal</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Avoid mocks and test your core domain faster with Hexagonal Architecture">
    <meta itemprop="description" content="As I’ve written in my last few posts, we can get a long way to avoid mocks with small scale coding best practices. Unfortunately, when systems reach a certain size, we need something at architecture scale.">
    <meta itemprop="datePublished" content="2018-05-24T06:43:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Avoid mocks and test your core domain faster with Hexagonal Architecture
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>As I’ve written in my last few posts, we can get a long way to avoid mocks with small scale coding best practices. Unfortunately, when systems reach a certain size, we need something at architecture scale.</p>

<p>This is the 6th post of a <a href="https://philippe.bourgau.net/categories/#how-to-avoid-mocks-series">series about avoiding mocks</a>. If you haven’t, you can start by <a href="https://philippe.bourgau.net/careless-mocking-considered-harmful/">the beginning</a>.</p>

<p><img src="https://philippe.bourgau.net/imgs/2018-05-24-avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/hexagonal-building.jpg" alt="A drawing of a hexagon-shaped building" /></p>

<h2 id="why-do-we-end-up-with-mocks-in-large-systems-">Why do we end up with mocks in large systems ?</h2>

<p>A few years ago, I joined a team working in a legacy system. We wanted to apply <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a> and refactoring. As expected, adding tests legacy code proved a real challenge. With a lot of effort we could manage to add a few. Unfortunately, this did not seem to have any positive effect on our maintainability ! The tests we were writing all involved a lot of mocking. The system was such a large mass of spaghetti code that there was no clear place to mock. We were actually mocking where it seemed the easiest on a test by test basis. We were making progress at small scale, but the big picture was not improving at all !</p>

<p>Large systems are beasts with many faces. They  involve a lot of IOs. They write and read data from the disk and databases. They call 3rd parties and remote services.</p>

<p>As we test these large systems, we’ll need to stub out these IOs. Even if the tests are fast enough, we usually don’t want to call external services for real. Most of the time though, tests are slow. That’s 2 reasons why end up adding some mocks.</p>

<p>Here comes the nasty part. These large systems are so complex that we, developers, don’t have the full picture. When we test, we tend to mock at different places, depending on our knowledge. This is bad for maintenance. Mocks duplicate production code behavior. When many different mocks are in place to isolate an external dependency, we end up with ‘n’ versions of the code. That’s a nightmare to refactor !</p>

<blockquote>
  <p>💡 When many different mocks are in place to isolate an external dependency, we end up with ‘n’ versions of the code !</p>
</blockquote>

<h2 id="hexagonal-architecture-to-the-rescue">Hexagonal architecture to the rescue</h2>

<p><a href="http://alistair.cockburn.us/Hexagonal+architecture">Alistair Cockburn</a> coined the term. The idea is pretty simple :  isolate a piece of code from all dependencies. This is particularly useful for the core bounded contexts. With this in place, it becomes straightforward (and fast) to test the core domain logic.</p>

<p>To main techniques to isolate a piece of code from any dependency are :</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Dependency_injection">Dependency injection</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Observer_pattern">Observers</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Adapter_pattern">Adapters</a></li>
</ul>

<p>It’s also possible to split a system in many ‘hexagons’ and glue them together with adapters at startup. If you want to learn more on this style of architecture, have a look into the <a href="https://www.infoq.com/articles/ddd-contextmapping">Domain Driven Design lore</a>. This community has been building systems this way for years now.</p>

<h2 id="enough-talk-show-me-the-code-">Enough talk, show me the code !</h2>

<p>This post was the occasion to try to inject a Hexagonal Architecture and a dash of DDD in a Rails application. There’s one caveat though : DDD shines on complex systems. Unfortunately, large and complex systems make very poor didactic examples. The following code highlights the gains about mocking. We would not use DDD for such a small app in real life.</p>

<h3 id="the-starting-point">The starting point</h3>

<p>I chose a simple TODO app. I started by generating a scaffold for a Task with a description and a done/not-done status. As third party interaction, completing a task sends an automatic tweet. Here is the only specific code I wrote on top of the Rails scaffold :</p>

<h6 id="appmodelstaskrb">app/models/task.rb</h6>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Task</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Dirty</span>

  <span class="n">validates</span> <span class="ss">:description</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>

  <span class="n">before_save</span> <span class="ss">:tweet_if_done</span>

  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">tweet_if_done</span>
    <span class="k">if</span> <span class="n">done_changed?</span>
      <span class="no">TwitterClient</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="nf">description</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Thanks Jason Charnes for the <a href="https://jasoncharnes.com/changed-attributes-rails/">change attribute technique</a>.</p>

<h6 id="specmodelstask_specrb">spec/models/task_spec.rb</h6>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'rails_helper'</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">Task</span><span class="p">,</span> <span class="ss">type: :model</span> <span class="k">do</span>

  <span class="n">it</span> <span class="s2">"is valid with all attributes set"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="no">Task</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">description: </span><span class="s2">"Finish presentation"</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">false</span><span class="p">)).</span><span class="nf">to</span> <span class="n">be_valid</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s2">"requires a description"</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="no">Task</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">description: </span><span class="kp">nil</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">false</span><span class="p">)).</span><span class="nf">to</span> <span class="n">be_invalid</span>
    <span class="n">expect</span><span class="p">(</span><span class="no">Task</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">description: </span><span class="s2">""</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">false</span><span class="p">)).</span><span class="nf">to</span> <span class="n">be_invalid</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s2">"tweets when a task is finished"</span> <span class="k">do</span>
    <span class="n">task</span> <span class="o">=</span> <span class="no">Task</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">description: </span><span class="s2">"Wash the car"</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">false</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="no">TwitterClient</span><span class="o">::</span><span class="no">Client</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:update</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="s2">"Wash the car"</span><span class="p">)</span>

    <span class="n">task</span><span class="p">.</span><span class="nf">done</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="n">task</span><span class="p">.</span><span class="nf">save</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This is pretty simple and to the point !</p>

<h3 id="5-years-later">5 years later</h3>

<p>Now let’s imagine that the app grew to tens of thousands of lines. We added a lot of features to the app, which transformed the TODO domain into a very complex thing. Now suppose that, for the sake of maintenance, we want to isolate the domain logic into its own hexagon. Unlike traditional Rails ActiveRecords, we want to make it independent from the database. We also want it to be independent from the Twitter API.</p>

<p>Here is what the code might look like.</p>

<h6 id="libcoretaskrb">lib/core/task.rb</h6>

<p>First, we have a core task class, independent from anything else. The Core module is our hexagon.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Core</span>
  <span class="k">class</span> <span class="nc">Task</span>

    <span class="nb">attr_reader</span> <span class="ss">:description</span>
    <span class="nb">attr_accessor</span> <span class="ss">:db_id</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{})</span>
      <span class="vi">@description</span><span class="o">=</span> <span class="s2">"What do you need to do ?"</span>
      <span class="vi">@done</span> <span class="o">=</span> <span class="kp">false</span>
      <span class="vi">@done_subscribers</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="nb">self</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">attributes</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">done?</span>
      <span class="vi">@done</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">mark_as_done</span>
      <span class="vi">@done</span> <span class="o">=</span> <span class="kp">true</span>
      <span class="vi">@done_subscribers</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span><span class="o">|</span><span class="nb">proc</span><span class="o">|</span> <span class="nb">proc</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">{})</span>
      <span class="nb">self</span><span class="p">.</span><span class="nf">description</span><span class="o">=</span> <span class="n">attributes</span><span class="p">[</span><span class="ss">:description</span><span class="p">]</span> <span class="k">unless</span> <span class="n">attributes</span><span class="p">[</span><span class="ss">:description</span><span class="p">].</span><span class="nf">nil?</span>
      <span class="nb">self</span><span class="p">.</span><span class="nf">mark_as_done</span> <span class="k">if</span> <span class="n">attributes</span><span class="p">[</span><span class="ss">:done</span><span class="p">]</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">notify_when_done</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">proc</span><span class="p">)</span>
      <span class="vi">@done_subscribers</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nb">proc</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">description</span><span class="o">=</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
      <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Task description cannot be blank"</span><span class="p">)</span> <span class="k">if</span> <span class="n">desc</span><span class="p">.</span><span class="nf">blank?</span>

      <span class="vi">@description</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>As we can see, it contains only domain logic and nothing else.</p>

<p>####### spec/lib/core/task_spec.rb</p>

<p>Here is the corresponding test, fast, mock-free and independent from the database and any external system.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'rails_helper'</span>
<span class="nb">require</span> <span class="s1">'core/task'</span>

<span class="n">context</span> <span class="s1">'Task'</span> <span class="k">do</span>

  <span class="n">let</span><span class="p">(</span><span class="ss">:task</span><span class="p">)</span> <span class="p">{</span> <span class="no">Core</span><span class="o">::</span><span class="no">Task</span><span class="p">.</span><span class="nf">new</span><span class="p">}</span>

  <span class="n">specify</span> <span class="s1">'is not done by default'</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">).</span><span class="nf">not_to</span> <span class="n">be_done</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'comes with a default description'</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">).</span><span class="nf">not_to</span> <span class="n">be_blank</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'it can be initialized from a hash'</span> <span class="k">do</span>
    <span class="n">task</span> <span class="o">=</span> <span class="no">Core</span><span class="o">::</span><span class="no">Task</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">description: </span><span class="s2">"Old description"</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">true</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"Old description"</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">).</span><span class="nf">to</span> <span class="n">be_done</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'can have a custom description'</span> <span class="k">do</span>
    <span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="o">=</span> <span class="s2">"Clean up the house"</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"Clean up the house"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'forbids empty descriptions'</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">{</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span> <span class="o">=</span> <span class="kp">nil</span> <span class="p">}.</span><span class="nf">to</span> <span class="n">raise_error</span><span class="p">(</span><span class="no">ArgumentError</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">{</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span> <span class="o">=</span> <span class="s2">""</span> <span class="p">}.</span><span class="nf">to</span> <span class="n">raise_error</span><span class="p">(</span><span class="no">ArgumentError</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'can be done'</span> <span class="k">do</span>
    <span class="n">task</span><span class="p">.</span><span class="nf">mark_as_done</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">).</span><span class="nf">to</span> <span class="n">be_done</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'publishes when done'</span> <span class="k">do</span>
    <span class="n">done_task</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="n">task</span><span class="p">.</span><span class="nf">notify_when_done</span> <span class="p">{</span><span class="o">|</span><span class="n">t</span><span class="o">|</span> <span class="n">done_task</span> <span class="o">=</span> <span class="n">t</span><span class="p">}</span>

    <span class="n">task</span><span class="p">.</span><span class="nf">mark_as_done</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">done_task</span><span class="p">).</span><span class="nf">to</span> <span class="n">be</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'can be updated with a hash'</span> <span class="k">do</span>
    <span class="n">task</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">description: </span><span class="s2">"New description"</span><span class="p">,</span> <span class="ss">done: </span><span class="kp">true</span><span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"New description"</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">).</span><span class="nf">to</span> <span class="n">be_done</span>
  <span class="k">end</span>

  <span class="n">specify</span> <span class="s1">'has no DB id by default'</span> <span class="k">do</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">).</span><span class="nf">to</span> <span class="n">be_nil</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>####### lib/infrastructure/task_repo.rb</p>

<p>To read and save with the database, we now go through an adapter. This is not considered to be part of our core domain.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Infrastructure</span>
  <span class="k">class</span> <span class="nc">TaskRepo</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">all</span>
      <span class="no">Task</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">db_task</span><span class="o">|</span>
        <span class="n">from_db</span><span class="p">(</span><span class="n">db_task</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">load</span><span class="p">(</span><span class="n">db_id</span><span class="p">)</span>
      <span class="n">from_db</span><span class="p">(</span><span class="no">Task</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">db_id</span><span class="p">))</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">save</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">.</span><span class="nf">nil?</span>
        <span class="n">db_task</span> <span class="o">=</span> <span class="no">Task</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="n">to_db_attributes</span><span class="p">(</span><span class="n">task</span><span class="p">))</span>
        <span class="n">task</span><span class="p">.</span><span class="nf">db_id</span> <span class="o">=</span> <span class="n">db_task</span><span class="p">.</span><span class="nf">id</span>
      <span class="k">else</span>
        <span class="n">db_task</span> <span class="o">=</span> <span class="no">Task</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">)</span>
        <span class="n">db_task</span><span class="p">.</span><span class="nf">update!</span><span class="p">(</span><span class="n">to_db_attributes</span><span class="p">(</span><span class="n">task</span><span class="p">))</span>
      <span class="k">end</span>
      <span class="n">task</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
      <span class="k">unless</span> <span class="n">task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">.</span><span class="nf">nil?</span>
        <span class="n">db_task</span> <span class="o">=</span> <span class="no">Task</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">)</span>
        <span class="n">db_task</span><span class="p">.</span><span class="nf">destroy!</span>
        <span class="n">task</span><span class="p">.</span><span class="nf">db_id</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="kp">private</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">to_db_attributes</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
      <span class="p">{</span><span class="ss">description: </span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">,</span> <span class="ss">done: </span><span class="n">task</span><span class="p">.</span><span class="nf">done?</span><span class="p">}</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_db</span><span class="p">(</span><span class="n">db_task</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="no">Core</span><span class="o">::</span><span class="no">Task</span><span class="p">.</span><span class="nf">new</span>
      <span class="n">result</span><span class="p">.</span><span class="nf">db_id</span> <span class="o">=</span> <span class="n">db_task</span><span class="p">.</span><span class="nf">id</span>
      <span class="n">result</span><span class="p">.</span><span class="nf">description</span> <span class="o">=</span> <span class="n">db_task</span><span class="p">.</span><span class="nf">description</span>
      <span class="n">result</span><span class="p">.</span><span class="nf">mark_as_done</span> <span class="k">if</span> <span class="n">db_task</span><span class="p">.</span><span class="nf">done?</span>
      <span class="n">result</span>
    <span class="k">end</span>

  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>####### app/controllers/tasks_controller.rb</p>

<p>Finally, all the pieces interact together in the controller. This controller basically does what the previous version was, it’s just using different classes. Obviously, we’ll need to adapt the views and the tests.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'core/task'</span>
<span class="nb">require</span> <span class="s1">'infrastructure/task_repo'</span>

<span class="k">class</span> <span class="nc">TasksController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">before_action</span> <span class="ss">:set_task</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:show</span><span class="p">,</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:destroy</span><span class="p">]</span>

  <span class="c1"># GET /tasks</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@tasks</span> <span class="o">=</span> <span class="no">Infrastructure</span><span class="o">::</span><span class="no">TaskRepo</span><span class="p">.</span><span class="nf">all</span>
  <span class="k">end</span>

  <span class="c1"># GET /tasks/1</span>
  <span class="k">def</span> <span class="nf">show</span>
  <span class="k">end</span>

  <span class="c1"># GET /tasks/new</span>
  <span class="k">def</span> <span class="nf">new</span>
    <span class="vi">@task</span> <span class="o">=</span> <span class="no">Core</span><span class="o">::</span><span class="no">Task</span><span class="p">.</span><span class="nf">new</span>
  <span class="k">end</span>

  <span class="c1"># GET /tasks/1/edit</span>
  <span class="k">def</span> <span class="nf">edit</span>
  <span class="k">end</span>

  <span class="c1"># POST /tasks</span>
  <span class="k">def</span> <span class="nf">create</span>
    <span class="k">begin</span>
      <span class="vi">@task</span> <span class="o">=</span> <span class="no">Core</span><span class="o">::</span><span class="no">Task</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">task_params</span><span class="p">)</span>
      <span class="no">Infrastructure</span><span class="o">::</span><span class="no">TaskRepo</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="vi">@task</span><span class="p">)</span>

      <span class="n">redirect_to</span> <span class="n">task_url</span><span class="p">(</span><span class="vi">@task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">),</span> <span class="ss">notice: </span><span class="s1">'Task was successfully created.'</span>

    <span class="k">rescue</span> <span class="no">ArgumentError</span>
      <span class="n">render</span> <span class="ss">:new</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># PATCH/PUT /tasks/1</span>
  <span class="k">def</span> <span class="nf">update</span>
    <span class="k">begin</span>
      <span class="vi">@task</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">task_params</span><span class="p">)</span>
      <span class="no">Infrastructure</span><span class="o">::</span><span class="no">TaskRepo</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="vi">@task</span><span class="p">)</span>

      <span class="n">redirect_to</span> <span class="n">task_url</span><span class="p">(</span><span class="vi">@task</span><span class="p">.</span><span class="nf">db_id</span><span class="p">),</span> <span class="ss">notice: </span><span class="s1">'Task was successfully updated.'</span>

    <span class="k">rescue</span> <span class="no">ArgumentError</span>
      <span class="n">render</span> <span class="ss">:edit</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># DELETE /tasks/1</span>
  <span class="k">def</span> <span class="nf">destroy</span>
    <span class="no">Infrastructure</span><span class="o">::</span><span class="no">TaskRepo</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="vi">@task</span><span class="p">)</span>
    <span class="n">redirect_to</span> <span class="n">tasks_url</span><span class="p">,</span> <span class="ss">notice: </span><span class="s1">'Task was successfully destroyed.'</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">set_task</span>
      <span class="vi">@task</span> <span class="o">=</span> <span class="no">Infrastructure</span><span class="o">::</span><span class="no">TaskRepo</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
      <span class="vi">@task</span><span class="p">.</span><span class="nf">notify_when_done</span> <span class="k">do</span> <span class="o">|</span><span class="n">task</span><span class="o">|</span>
        <span class="no">TwitterClient</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="nf">description</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="c1"># Never trust parameters from the scary internet, only allow the white list through.</span>
    <span class="k">def</span> <span class="nf">task_params</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">permit</span><span class="p">(</span><span class="ss">:description</span><span class="p">,</span> <span class="ss">:done</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The main gain here is that our core domain, our most valuable asset is now easy to test without mocks. This means that we are able to write and execute fast tests for this area of the code. This puts us in a great position to increase our competitive advantage in our core business !</p>

<blockquote>
  <p>💡 By keeping your tests around your core domain fast, Hexagonal Architecture increases your competitive advantage.</p>
</blockquote>

<p>As you can see, we are now wiring everything together at the controller level. We could later build a facade to isolate the controller from the inside of our domain. A <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter">presenter</a> might do, but it seemed over-engineered, even in this made up example. (I’ll post something about that some day)</p>

<h2 id="next-post">Next post</h2>

<p>As we can deduce from the controller code above, we still have to use fakes or mocks when testing the controller. The good thing though is that this is now more local which already makes mocking less of an issue. If a mock is used in less tests, it’s easier to use the same mock everywhere ! This is a great opportunity for simplifying test setup, as we’ll see in the <a href="https://philippe.bourgau.net/get-rid-of-mocking-maintenance-with-full-fledged-in-memory-fakes/">next post about in-memory fakes</a>.</p>


<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<div id="mc_embed_signup">
  <form action="https://bourgau.us18.list-manage.com/subscribe/post?u=b46bc99339f9c9f337232c617&amp;id=ed63184b0e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
        <label for="mce-EMAIL">Stay up to date with content and upcoming products</label>
        <p>I usually write about 15 minutes worth of reading per month. I won't transfer your email. No Spam, unsubscribe whenever you want.</p>
        <p><em>As a gift for subscribing, you'll receive an illustrated mini-ebook <strong>"How to start a team coding dojo"</strong>!</em></p>
        <p><img src="/imgs/thumbnails/how-to-start-your-team-coding-dojo-cover.jpg"/></p>
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
        <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_b46bc99339f9c9f337232c617_ed63184b0e" tabindex="-1" value=""></div>
        <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
  </form>
</div>

<!--End mc_embed_signup-->

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#architecture" class="page__taxonomy-item" rel="tag">architecture</a><span class="sep">, </span>
    
      <a href="/categories/#ddd" class="page__taxonomy-item" rel="tag">ddd</a><span class="sep">, </span>
    
      <a href="/categories/#how-to-avoid-mocks-series" class="page__taxonomy-item" rel="tag">how-to-avoid-mocks-series</a><span class="sep">, </span>
    
      <a href="/categories/#mocking" class="page__taxonomy-item" rel="tag">mocking</a><span class="sep">, </span>
    
      <a href="/categories/#programming" class="page__taxonomy-item" rel="tag">programming</a><span class="sep">, </span>
    
      <a href="/categories/#ruby" class="page__taxonomy-item" rel="tag">ruby</a><span class="sep">, </span>
    
      <a href="/categories/#tdd" class="page__taxonomy-item" rel="tag">tdd</a><span class="sep">, </span>
    
      <a href="/categories/#testing" class="page__taxonomy-item" rel="tag">testing</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-05-24T06:43:00+00:00">May 24, 2018</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=pbourgau&text=Avoid+mocks+and+test+your+core+domain+faster+with+Hexagonal+Architecture%20https%3A%2F%2Fphilippe.bourgau.net%2Favoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>


  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fphilippe.bourgau.net%2Favoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

  <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fphilippe.bourgau.net%2Favoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture%2F&title=Avoid+mocks+and+test+your+core+domain+faster+with+Hexagonal+Architecture" class="btn" style="background-color: #ff4500; color: white" title="Share on Reddit"><i class="fab fa-fw fa-reddit" aria-hidden="true"></i><span> Reddit</span></a>

  <a href="http://news.ycombinator.com/submitlink?u=https%3A%2F%2Fphilippe.bourgau.net%2Favoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture%2F&t=Avoid mocks and test your core domain faster with Hexagonal Architecture" class="btn" style="background-color: #ff6600; color: white"  title="Share on Hackernews"><i class="fab fa-fw fa-hacker-news" aria-hidden="true"></i><span> Hacker News</span></a>

</section>


      
  <nav class="pagination">
    
      <a href="/how-custom-assertion-matchers-will-keep-mocks-away/" class="pagination--pager" title="How Custom Assertion Matchers will keep mocks away
">Previous</a>
    
    
      <a href="/get-rid-of-mocking-maintenance-with-full-fledged-in-memory-fakes/" class="pagination--pager" title="Get rid of mock maintenance with full fledged in-memory fakes
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/imgs/2023-11-07-the-secrets-of-tech-coaching-better-communication-skill/human-human-stack-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/the-secrets-of-tech-coaching-better-communication-skill/" rel="permalink">The Secrets Of Tech Coaching: Better Communication Skill
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          17 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Running code katas or mobs with groups that lack teamwork is almost impossible! Here are 20 communication and collaboration techniques to coach by example.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/imgs/2023-07-22-liberating-structures-the-slow-code-retreat-s-little-facilitation-secret/snail-carrying-liberating-structures-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/liberating-structures-the-slow-code-retreat-s-little-facilitation-secret/" rel="permalink">Liberating Structures: the Slow Code Retreat’s little facilitation secret
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">You can now run the Slow Code Retreat by following the facilitation guide. By doing so, you’ll also learn 6 Liberating Structures for your future workshops.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/imgs/2023-06-04-how-to-fix-bad-agile-by-discussing-baby-steps/baby-steps-aha-moment-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-fix-bad-agile-by-discussing-baby-steps/" rel="permalink">How To Fix Bad Agile By Discussing Baby Steps
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">How to fix bad agile by starting neutral discussions about baby-steps programming. Baby steps are a sustainable and productive approach to writing code.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/imgs/2023-04-26-a-quality-view-workshop-to-discuss-technical-excellence/missing-a-quality-view-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a-quality-view-workshop-to-discuss-technical-excellence/" rel="permalink">A Quality View Workshop to Discuss Technical Excellence
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          17 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here is a step-by-step workshop to guide a team to drawing a Quality View. Use it to discuss investment in agile technical excellence with stakeholders.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/pbourgau" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/philou" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
        
          <li><a href="https://www.linkedin.com/in/philippe-bourgau-607a928" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="http://eepurl.com/dxKE95" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Mail Feed</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Philippe Bourgau. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0XLKP12EJF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0XLKP12EJF', { 'anonymize_ip': true});
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://philippe.bourgau.net/avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/avoid-mocks-and-test-your-core-domain-faster-with-hexagonal-architecture"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://philippe-bourgau.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
