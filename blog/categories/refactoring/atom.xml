<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: refactoring | Philippe Bourgau's blog]]></title>
  <link href="http://philippe.bourgau.net/blog/categories/refactoring/atom.xml" rel="self"/>
  <link href="http://philippe.bourgau.net/"/>
  <updated>2018-09-06T06:18:43+02:00</updated>
  <id>http://philippe.bourgau.net/</id>
  <author>
    <name><![CDATA[Philippe Bourgau]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Presenting a large scale refactoring as a business opportunity]]></title>
    <link href="http://philippe.bourgau.net/presenting-a-large-scale-refactoring-as-a-business-opportunity/"/>
    <updated>2018-09-06T06:27:00+02:00</updated>
    <id>http://philippe.bourgau.net/presenting-a-large-scale-refactoring-as-a-business-opportunity</id>
    <content type="html"><![CDATA[<p>Have you ever tried to talk about refactoring with business people ? Most of the time, the matter is pushed aside or received with rolling eyes &hellip; A few weeks ago, someone on <a href="https://news.ycombinator.com/">Hacker News</a> asked the question &ldquo;<a href="https://news.ycombinator.com/item?id=17600503&amp;utm_source=hackernewsletter&amp;utm_medium=email&amp;utm_term=ask_hn">As a CTO, what is your most frustrating problem with technical debt?</a>&rdquo;. Here is the most voted answer</p>

<blockquote><p>I think a lot of the time when a developer shouts ‚Äútechnical debt‚Äù what they are really shouting is ‚Äúcode someone else wrote that I‚Äôd rather rewrite than understand‚Äù. (The rest of the time is the same but they‚Äôve understood it enough to think it‚Äôs a disaster area.)</p>

<p>I have found it‚Äôs best to not take tech debt complaints very seriously and instead look at actual success metrics. For example if every change to a bit of code introduces new bugs then that might be a reason to tidy it up.</p>

<p><a href="https://github.com/ghiculescu">ghiculescu</a></p></blockquote>

<p>We need a constructive dialogue with business people to get sponsorship for important large scale refactorings. Let&rsquo;s see what we can do to have one. This is the 10th post of a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t start by <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a>.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-22-presenting-a-large-scale-refactoring-as-a-business-opportunity/refactoring-opportunity.jpg" alt="Drawing of a tree growing on top of the word refactoring. The key to getting sponsorship for a large scale refactoring is to present it as a business opportunity" /></p>

<h2>Presenting a business opportunity</h2>

<p>We must be very careful about how we present refactorings. We don&rsquo;t want them to be seen as unnecessary chores, or the latest tech fashion to follow. These don&rsquo;t bring value, and business people will run away from such refactorings. Instead, we should present business opportunities for higher productivity to invest in.</p>

<h3>Presenting a similar success story and its impact on the business</h3>

<p>Most of our companies have been through similar refactorings in the past. We can try to find a successful one and draw parallels to forecast benefits for the business. If the company is too young to have any or they were all failures, we can have a look in the whole industry. When I was at <a href="https://www.devoxx.fr/">Devoxx in Paris</a>, <a href="https://twitter.com/hervelourdin?lang=fr">Herv√© Lourdin</a> the CTO of <a href="https://www.videdressing.com/">VideDressing</a> presented how they managed to do a large scale refactoring. Among other things, he went over how he managed to get sponsorship from his board. If you understand French, have a look at <a href="https://www.youtube.com/watch?v=UZt07-dsTdU">the full talk</a>. In this case as in most, a likely promise of reduction in the costs of bugs and new features is what made the point.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/UZt07-dsTdU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>


<blockquote><p>üí° In most cases, a likely promise of reduction in the costs of bugs and new features is what gets a refactoring prioritized.</p></blockquote>

<h3>Be a Badass Developer</h3>

<p>I wrote a lot about being a <a href="/blog/categories/badass-developer/">badass developer</a> earlier in <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">this series</a>. This is when it becomes crucial. Being badass is a way to gain the trust of business people. Without this trust business people will react like the guy on Hacker News. Badass developers are way better at presenting large scale refactoring as business opportunities.</p>

<h3>Find a path to do incremental delivery</h3>

<p>Without incremental delivery, a refactoring risks delaying features for an unknown time. That scares the hell out of business people. <a href="/blog/categories/incremental-software-development/">Day to day incremental refactoring best practices</a> will save the day here. They&rsquo;ll actually help 3 times !</p>

<ol>
<li>To already perform a lot of refactoring in day to day work</li>
<li>To learn how to find an incremental refactoring path to present to business people</li>
<li>To prove that we know what we are talking about : we&rsquo;ve already been doing it for a while</li>
</ol>


<p>If you haven&rsquo;t, have a look at <a href="/blog/categories/incremental-software-development/">the articles about incremental refactoring techniques</a> that I wrote earlier in <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">this series</a>.</p>

<h2>Pitch It !</h2>

<p>In &ldquo;corporate&rdquo; environments, building credibility is a lot about being convincing. The more we learn to be convincing, the more likely we are to have our refactoring prioritized. If you are ready to spend some time learning how to pitch, I recommend reading <a href="https://www.amazon.com/Pitch-Anything-Innovative-Presenting-Persuading/dp/0071752854">Pitch Anything</a>. At least have a look at <a href="https://www.marketingfirst.co.nz/2013/10/pitch-anything-an-innovative-method-for-presenting-persuading-and-winning-the-deal-by-oren-klaff/">its summary</a>. It contains many actionnable nuggets to deliver powerful pitches. Here are a few.</p>

<p><a href="https://www.amazon.com/Pitch-Anything-Innovative-Presenting-Persuading/dp/0071752854"><img src="http://philippe.bourgau.net/imgs/2018-08-22-presenting-a-large-scale-refactoring-as-a-business-opportunity/pitch-anything.jpg" alt="Cover of the book Pitch Anything. Pitching a large scale refactoring as a business opportunity is a great way to get it prioritized" /></a></p>

<p>When we present an idea, we should put &ldquo;frames&rdquo; (time, authority &hellip;) in place to gain control of the discussion. For example, a time frame is a kind of deadline that will urge people to take action now. (Before overthinking it &hellip;)¬†</p>

<p>We should create tension by alternating phases where we are giving and phases where we take a step back. Following the same idea, it also mentions the <a href="https://en.wikipedia.org/wiki/The_Tao_of_Steve">Tao of Steve</a> to rule at negotiations :</p>

<ul>
<li>Don&rsquo;t want anything</li>
<li>Show that you are really good</li>
<li>Leave at the crucible moment</li>
</ul>


<p>Giving a great pitch is a great way to present large scale refactorings as business opportunities.</p>

<blockquote><p>üí° Pitching is a great skill for developers to get sponsorship for a refactoring.</p></blockquote>

<h2>More to come</h2>

<p>This was the 10th post in a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. In next week&rsquo;s post, I&rsquo;ll go over how to use a recent discovery about how our brain works to become even more convincing ! <a href="http://eepurl.com/dxKE95">Stay tuned</a> !</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Incremental Software Development Strategies for Large Scale Refactoring #4 : a Pattern Language]]></title>
    <link href="http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/"/>
    <updated>2018-08-30T08:15:00+02:00</updated>
    <id>http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language</id>
    <content type="html"><![CDATA[<p>This is the ninth post in a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t, I encourage you to start from <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a>. It&rsquo;s also the fourth about incremental software development strategies for large scale refactoring. My point is that it&rsquo;s not possible to sell a refactoring to business people until we master those :</p>

<ol>
<li>How to find the time to refactor in our daily work</li>
<li>How to learn to work in baby steps</li>
<li>How to organize and manage this ongoing effort as a team</li>
</ol>


<p>What about when it is not easy to split the work into incremental steps ? It can sometimes be a real challenge to integrate, let alone deploy, a refactoring step by step !</p>

<p>Do you remember the DSL parser refactoring story in mentioned in <a href="/incremental-software-development-techniques-for-large-scale-refactorings/">another post</a> ? Switching to a different parser technology incrementally sounds like an impossible mission. Even so, that&rsquo;s what we did !¬†</p>

<p>Here&rsquo;s another story. A long time ago, I was working in a bank. We were to migrate imperative <a href="http://www.cplusplus.com/">C++</a> financial contract models into declarative definitions in <a href="https://en.wikipedia.org/wiki/C_Sharp_(programming_language">C#</a>). We had to maintain an ugly adaptation layer. It made it possible migrate and deliver step by step. In the end, we suffered almost no bugs resulting from this transition.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/pattern.jpg" alt="Drawing of the pattern for a T-shirt. Patterns can be useful for Incremental Software Development of Large Scale Refactoring" /></p>

<h2>Why the effort ?</h2>

<p>Incremental refactoring implies going through Frankensteinesk intermediate situations. Situations where both the legacy and the new models exist in the software at the same time. This kind of adaptation layer costs time and energy, but doesn&rsquo;t add value to the product either ! What&rsquo;s the point of going through this ? Isn&rsquo;t a Big-Bang change cheaper ? Here is why it is still worth doing :</p>

<ol>
<li>It&rsquo;s safer. With incremental delivery, we confirm that what we are doing is working in production. On top of that, if something goes wrong, as we only delivered a small increment, the problem is easier to diagnose.</li>
<li>It&rsquo;s also safer in term of priorities. The system keeps working during all the refactoring. There&rsquo;s no pressure to finish it before we can move on to the next &lsquo;valuable&rsquo; feature. As <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/">I explained before</a> it makes it possible to pause, and why not stop there for the moment. This can be helpful if we hit a new urgent priority.</li>
<li>Finally, it creates value earlier. Instead of having to wait 2 months to get all the value, you start getting a bit of this value every week. Even refactoring create value ! They reduce the time wasted to fix bugs. They increase our productivity. Sometimes, they even improve Non Functional Requirements of the system.</li>
</ol>


<p><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/value.jpg" alt="Plot of value over time in incremental vs big-bang. We can see that incremental software development creates more value." /></p>

<p>As we can see, the goal of incremental refactoring is not only to work in small steps. We also want to find a way to deliver <em>value</em> incrementally !</p>

<blockquote><p>üí° Incremental refactoring is not only about baby steps, it&rsquo;s also about early value delivery !</p></blockquote>

<h2>A Mini pattern language</h2>

<p>As I said earlier, this is easier said than done. Some piece of code won&rsquo;t let you refactor them step by step easily. Some will be too obscure to know where to start. Some will be just huge. Others will depend on an all encompassing third party. etc.</p>

<p>Here is a short pattern language to deliver large scale refactorings incrementally.</p>

<h3><a href="https://www.infoq.com/news/2016/05/domain-experts-ddd">Discuss with a domain experts</a></h3>

<h4>Goal</h4>

<p>We need to refactor code containing a lot of domain knowledge</p>

<h4>Conditions</h4>

<p>We have a domain expert available</p>

<h4>Therefore</h4>

<p>Have regular discussions with the domain expert to find the best modeling possible.</p>

<h4>Consequences</h4>

<ul>
<li>üíö We get simpler code than by trying to replicate the twisted legacy logic</li>
<li>üíö Can save a lot of work by skipping deprecated aspects.</li>
<li>üíö Chance to get bug fixes or new features for free</li>
<li>‚ö†Ô∏è The system does not exactly behave as it used to, which can cause integration problems</li>
</ul>


<h4>Difficulties</h4>

<p>It can sometimes be difficult to find a domain expert &hellip;</p>

<p>A lot of the presentations at the July Paris DDD Meetup were about how to find domain experts. Who actually seem to be pretty rare beasts ! Here are my notes.</p>

<p><a href="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/ddd-from-the-trenches.jpg"><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/ddd-from-the-trenches-small.jpg" alt="Mind map of my notes at July Paris DDD Meetup. The point was how to find a domain expert" /></a></p>

<h3><a href="http://dddcommunity.org/library/evans_2011_2/2">Bubble context</a></h3>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/bubble-context.jpg" alt="Drawing of developer and business expert inflating a bubble together. The bubble context is a way to incrementally grow a large scale refactoring from within the software" /></p>

<h4>Goal</h4>

<p>We want to refactor a large piece of code with no Big-Bang</p>

<h4>Conditions</h4>

<p>We have access to the internals of the code to refactor</p>

<h4>Therefore</h4>

<ul>
<li>Create a new bubble of clean code (a namespace, a package &hellip;)</li>
<li>Rewrite a piece of legacy code in the bubble</li>
<li>From the legacy code, delegate to the bubble</li>
<li>Repeat until the legacy code is not used anymore</li>
</ul>


<h4>Consequences</h4>

<ul>
<li>üíö Enables a step by step continuous delivery of the new version</li>
<li>üíö It is possible to eventually transform the API of the system</li>
<li>üíö It&rsquo;s easy to add new features in the bubble long before the refactoring is over</li>
</ul>


<h4>Difficulties</h4>

<ul>
<li>Need to understand the legacy enough to find good delegation points</li>
<li>Need to understand what the old small piece of code was doing to re-write it. A domain expert might be mandatory.</li>
</ul>


<h3><a href="https://www.martinfowler.com/bliki/StranglerApplication.html">Strangler</a></h3>

<p>The bubble context grows from the inside, but the strangler starts from the outside.</p>

<h4>Goal</h4>

<p>We want to refactor a large piece of code with no Big-Bang</p>

<h4>Conditions</h4>

<p>We can keep the same interface (API) for the legacy and the refactored versions</p>

<h4>Therefore</h4>

<ul>
<li>Wrap the existing code</li>
<li>Re-implement calls in the wrapper</li>
<li>Delegate the rest to the legacy</li>
<li>Repeat until you support all the interface</li>
<li>Remove the legacy code</li>
</ul>


<h4>Consequences</h4>

<ul>
<li>üíö Enables a step by step continuous delivery of the new version</li>
<li>‚ö†Ô∏è Maintenance of the wrapper and both versions of the code during all the refactoring</li>
</ul>


<h4>Difficulties</h4>

<ul>
<li>Interaction between the legacy and the refactored version is not always as simple. For example when the wrapped code is stateful</li>
<li>The granularity of the steps is the (method) calls to the interface. They need to be small enough for the whole process to be incremental</li>
</ul>


<p>Remember my story about how we switched our DSL parser to <a href="http://www.antlr.org/">ANTLR</a> ? We used a Strangler to do this.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/strangler.jpg" alt="Drawings of a strangler plant growing around legacy code. The strangler is very effective to do incremental software development of doing large scale refactorings" /></p>

<h3><a href="https://martinfowler.com/articles/feature-toggles.html">Feature toggles</a></h3>

<p>Sometimes, we just don&rsquo;t find a way to deliver a refactoring to users step by step. I&rsquo;ve seen situations where all incremental paths implied a temporary impact on NFRs. Ex : Keeping both versions of the code implied an increase in resource consumption.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-14-incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/switch.jpg" alt="Drawings of an electric switch. Feature toggles are sometimes the last resort to do incremental software development of large scale refactoring" /></p>

<h4>Goal</h4>

<p>Incrementally build a refactoring that we cannot deliver piece by piece to all our users.</p>

<h4>Conditions</h4>

<p>When we cannot find a way to incrementally deliver our refactoring to bulk of our users</p>

<h4>Therefore</h4>

<p>From the code, dynamically switch to the different versions depending on runtime configuration. This way, we let most users stick to the legacy version. Yet, we can build, test, integrate and deploy the new version to beta testers.</p>

<h4>Consequences</h4>

<ul>
<li>üíö We can build, integrate and test our refactored code in baby steps</li>
<li>üíö We can beta and A/B test our refactored code</li>
<li>‚ö†Ô∏è We need to maintain and evolve both versions of the code for a long time</li>
<li>‚ö†Ô∏è We need to maintain the switches in the code</li>
<li>‚ö†Ô∏è We only deploy to beta testers, and don&rsquo;t get as much early value</li>
<li>‚ö†Ô∏è Duplicate the Continuous Delivery pipeline to test different feature toggle sets</li>
</ul>


<h4>Difficulties</h4>

<p>Maintaining <a href="https://dzone.com/articles/feature-toggles-are-one-worst">feature toggles is a mess</a>. Thus, we need to</p>

<ul>
<li>As much as possible, prepare the code to reduce the number of switches. Ref : <a href="https://martinfowler.com/bliki/BranchByAbstraction.html">Branch by abstraction</a></li>
<li>Hunt down the number of active feature toggles at any given time</li>
<li>Reduce the scope of toggles. Where possible, we should push things out of the toggle into stranglers or bubbles.</li>
</ul>


<p>Feature toggles are an alternate to branches. Even if toggles are painful to use, branches are worse ! I&rsquo;m not going to go over branches. If you want to see why we should not use branches, check <a href="http://videos.ncrafts.io/video/275529985">this talk</a>.</p>

<iframe src="https://player.vimeo.com/video/275529985" width="640" height="360" frameborder="0" allowfullscreen></iframe>


<blockquote><p>üí° Feature toggles are painful, but branches are worse !</p></blockquote>

<h2>Final word</h2>

<p>I&rsquo;m done writing about Incremental Software Development Strategies for Large Scale Refactoring. This is only what I currently know about this very important topic. There&rsquo;s one last thing we need to do to be successful at it. We all need to keep an eye on new ideas from the community, and to share this with our teams as much as possible.</p>

<p>This was the ninth post in <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">a series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t start by <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a> ! In <a href="/presenting-a-large-scale-refactoring-as-a-business-opportunity/">next post</a>, I&rsquo;ll start to go over how to present a refactoring in financial terms to business people.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Incremental Software Development Strategies for Large Scale Refactoring #3 : Manage it !]]></title>
    <link href="http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/"/>
    <updated>2018-08-23T06:53:00+02:00</updated>
    <id>http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it</id>
    <content type="html"><![CDATA[<p><a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/">My previous posts</a> where about how to find and use small time slots for large scale refactorings. <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/">Refactoring step by step</a> is a series of slack slots, sub tasks of features and boy scout rule increments. Unfortunately, keeping track of all these is a challenge of its own.</p>

<p>Here is a little story of what can go bad. I used to work in a team which <a href="/refactoring-trick-to-insert-a-wrapper/">had a high &lsquo;refactoring culture&rsquo;.</a> Everyone in the team wanted to apply the kind of practices I mentioned in my previous posts. To make things more tricky, we were <a href="/from-zero-to-pair-programming-hero/">working from 2 cities</a>. We had introduced slack time and developers would tackle refactoring at the end of every iteration. As we did not particularly organize or collaborate on slack time, we soon ran into conflicts. People wanted to refactor the same code, maybe in different ways ! After a while we also had too many large scale refactorings going on at the same time. This slowed down progress, increased the <a href="https://en.wikipedia.org/wiki/Bus_factor">bus factor</a> and the failure rate. Worst of all, it made it difficult to refocus on a newly discovered but urgent refactoring.</p>

<p>With a bit of organization though, we got things to work. Let&rsquo;s see how we managed it.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-08-incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/manage-it.jpg" alt="Drawing of a calendar entitled &quot;Manage It !&quot;. Collaboration and organization are key to succeed to use incremental software development for large scale refactorings." /></p>

<p>This is the eighth post in a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t, I encourage you to start from <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a>.</p>

<h2>Manage it with a Design Vision</h2>

<p>To succeed at anything, we need to know where we are going. It&rsquo;s the same for large scale refactorings. We don&rsquo;t need to have all the details of what we want to build. We do need a good enough draft to avoid going in the wrong direction. That&rsquo;s even more true when we work as a team. Without a shared design vision, people will refactor in conflicting directions.</p>

<p>It&rsquo;s very important to share the vision with all the team. We can stick high level UML sketches on the walls for example. As <a href="https://twitter.com/kentbeck">Kent Beck</a> suggests, we can also use <a href="http://www.extremeprogramming.org/rules/metaphor.html">metaphores</a> to communicate the design. In <a href="https://vimeo.com/275530146">this talk</a>, <a href="http://www.natpryce.com/">Nat Pryce</a> explains that it&rsquo;s a great way start, but that we will have to drop the metaphore later.</p>

<iframe src="https://player.vimeo.com/video/275530146?title=0&byline=0&portrait=0" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>


<div class="image-credits">By <a href="https://vimeo.com/275530146">Nat Pryce - What we talk about when we talk about software</a> from <a href="https://vimeo.com/newcrafts">NEWCRAFTS Conferences</a> on <a href="https://vimeo.com">Vimeo</a></div>


<br>


<p>The idea is not to waste time in a <a href="https://en.wikipedia.org/wiki/Big_Design_Up_Front">Big Design Up Front</a>. We just want to draft a vision :</p>

<ul>
<li>We can run a Design level Event Storming (I guess I&rsquo;ll have to blog about this some day)</li>
<li>We can grab a copy of <a href="https://www.amazon.com/Gamestorming-Playbook-Innovators-Rulebreakers-Changemakers/dp/0596804172/ref=sr_1_1?ie=UTF8&amp;qid=1534409953&amp;sr=8-1&amp;keywords=gamestorming">Gamestorming</a> and run another kind of collaborative design game</li>
<li>Or a few team members could work on something the way they prefer</li>
</ul>


<p>Whatever the technique we start with, we&rsquo;ll be able to refine and evolve the vision down the road.</p>

<h2>Manage it with Mikado Graphs</h2>

<p>Remember the &lsquo;<a href="http://mikadomethod.info/">Mikado Method</a>&rsquo; from <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/">my previous post</a> ? It&rsquo;s a technique to code and deploy large scale refactorings in baby steps. If you had a look at the reference links, you&rsquo;ll might seen mentions of a &lsquo;Mikado Graph&rsquo;. Here is what it looks like :</p>

<p><a href="http://mikadomethod.info/"><img src="http://philippe.bourgau.net/imgs/2018-08-08-incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/mikado-graph.png" alt="Sample Mikado Graph. The Mikado graph is a great tool to manage and collaborate on incremental software development of large scale refactoring." /></a></p>

<div class="image-credits">Sample mikado graph from <a href="http://mikadomethod.info/">http://mikadomethod.info/</a></div>


<br>


<p>As the number of refactoring steps grows, it becomes tricky to keep track of them all. A simple way is to draw them as nodes in a graph, and tackle the work from the leaves. If you are interested, check <a href="/blog/categories/mikado-method/">these posts about the Mikado Method</a>. In my previous team, we became fans of the Mikado Method. We even built a tool to generate mikado graph from <a href="https://www.atlassian.com/software/jira">JIRA</a> (our ticket management system) dependencies ! Using colors, we could track where we stood in the refactoring.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-08-incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/generated-mikado-graph.jpg" alt="Sample Mikado Graph generated by our tool. Automating around Mikado graphs is of great help for large scale refactoring." /></p>

<p>The key advantage of mikado graphs is that we can stick them on the wall. This enables all the team to know where we stand in a refactoring. This way, team members can collaborate during their slack. It can also make the boy scout rule more effective. When a developer happens to touch a file that appears in the graph, he or she can move it further in the good direction.</p>

<blockquote><p>üí° A key benefit of mikado graphs is that we can stick them on the wall for everyone to know where we stand in a refactoring.</p></blockquote>

<h2>Manage it with Metrics</h2>

<p>I mentioned coding conventions and a clear <a href="https://www.agilealliance.org/glossary/definition-of-done/">Definition of Done</a> in <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/">a previous post</a>. ¬†Having code quality constraints is the compass of constant merciless refactoring. To make this actionable and real, we should take the time to setup an automatic metrics system. For example :</p>

<p><a href="https://youtu.be/Env47tQewIA?t=2685"><img src="http://philippe.bourgau.net/imgs/2018-08-08-incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/tech-debt-trap.jpg" alt="Doc Norton's talk about &quot;The Technical Debt trap&quot;. His metrics are very useful to manage large scale refactoring." /></a></p>

<ul>
<li><a href="https://www.youtube.com/watch?v=Env47tQewIA">Doc Norton suggests</a> to track maintainability, coverage, complexity and coupling over time.</li>
<li>The <a href="https://www.agilealliance.org/the-agile-alliance-debt-analysis-model/">A2DAM model</a> suggests using specific rules to create Definition of Done constraints</li>
</ul>


<p>Putting this in place will help everyone in the team to know if she or he should do more or less refactoring. The first benefit is that it prevents under and over engineering on new code. The second benefit is progress validation through metrics changes as we refactor.</p>

<p><a href="https://codeclimate.com/github/philou/planning-poker"><img src="http://philippe.bourgau.net/imgs/2018-08-08-incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/code-climate-dashboard.jpg" alt="Sample metrics dashboard. Out of the box, Code Climate supports 3 out of the 4 metrics suggested by Doc Norton. This can be really helpful to manage incremental software development." /></a></p>

<h2>Manage it with a bit of Planning</h2>

<p>Granted, planning is not the most fun part of our job. It can save us a ton of work though. <a href="https://code.joejag.com/2018/lego-workstream-visualisation.html">Joe Wright explains</a> how they doubled their productivity by spending more time planning. If we want to make a good job of incremental refactoring, we&rsquo;ll need to spend enough time preparing it. Important questions are :</p>

<ul>
<li>What are the most important refactorings to work on ?</li>
<li>How many refactorings should we tackle at the same time ?</li>
<li>Are we making good progress on our refactorings ?</li>
<li>Why is this refactoring not yielding any visible results through our metrics system ?</li>
<li>Are there any news that should change our plans ?</li>
<li>Are we doing enough refactoring to keep things under control ?</li>
<li>What are the next steps in these refactorings ?</li>
<li>etc</li>
</ul>


<p>I&rsquo;m not talking about a big 6 month planning but rather regular short planning sessions. In <a href="https://www.scrum.org/">Scrum</a> this kind of planning happens every sprint. To make plannings more visual, engaging and fun, we might us something like <a href="https://jpattonassociates.com/user-story-mapping/">Story Mapping</a>. (I guess I should blog about this someday.)</p>

<blockquote><p>üí° Keeping a Work In Progress limit on refactorings is essential.</p></blockquote>

<h2>Manage it through Time-Boxing</h2>

<p>One last advice before I&rsquo;m done. We must be very careful to time-box our work on refactoring increments. It&rsquo;s all too easy, to get caught up in a refactoring during the slack at the end of the iteration. If we let the refactoring spill on features we risk loosing the business people&rsquo;s trust.</p>

<p>Here again, using extra small baby steps helps to pause the refactoring. Another way is to do <a href="https://en.wikipedia.org/wiki/Kanban_(development">Kanban</a>) style slack. Replace end of sprint slack by a fixed number of people slacking all the time. But I&rsquo;ll come back to this in more details in a future post.</p>

<h2>Next post</h2>

<p>Using this set of practices my team was able to deliver large scale refactorings in small steps. That said, some refactorings are very difficult to technically deliver incrementally. Fortunately, people have come up with patterns like the Strangler and the Bubble Context to cope with this. That&rsquo;s what I&rsquo;ll go over in the <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-4-a-pattern-language/">next post</a>.</p>

<p>This was the eighth post in <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">a series about how to get sponsorship for large scale refactoring</a>. I&rsquo;ve already been through why it&rsquo;s so difficult to get sponsorship for a refactoring. Why a badass developer attitude is important ? How to deliver refactorings steps by steps ? If you haven&rsquo;t start by <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a> !</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Incremental Software Development Strategies for Large Scale Refactoring #2 : Baby Steps]]></title>
    <link href="http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/"/>
    <updated>2018-08-09T08:50:00+02:00</updated>
    <id>http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps</id>
    <content type="html"><![CDATA[<p><a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/">My previous post</a> was about how to get slots of time in your daily (or weekly) work to do some refactoring. I left my readers with the promise of techniques to fit the refactoring work into these small slots.</p>

<p>Obviously, it won&rsquo;t be possible to perform any refactoring of any size in this way. With a bit of discipline and know-how though, it is possible to deal with quite a lot by splitting them up.</p>

<p>Baby steps are small increments of working software. The idea is that we test, commit, integrate and even deploy every small code change ! Using baby steps, we can perform large scale refactorings little by little. Refactoring in this way might seem involved, but it&rsquo;s so much safer that it&rsquo;s <a href="/7-reasons-why-learning-refactoring-techniques-will-improve-your-life-as-a-software-engineer/">a no brainer once you&rsquo;ve tried it</a> ! Refactoring in baby steps can be challenging to master though.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-07-incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/baby-steps.jpg" alt="Baby footprints. Taking really small baby steps when going through a large scale refactoring is safer" /></p>

<p>10 years ago, I used to work in a large bank in Paris. I had been dabbling on my own with <a href="https://en.wikipedia.org/wiki/Extreme_programming">eXtreme Programming</a> for a few years, when we started a small project. I was to become the informal XP coach. The project was about connecting to an online brokering service. It involved adapting an existing domain library. It went out pretty well. More precisely, we created very few bugs in production, which was very different from the norm at the time. I remember this feedback from the manager :</p>

<blockquote><p>We managed to move the code from X to Y through a succession of working baby steps ! That&rsquo;s pretty uncommon ! A manager in 2006</p></blockquote>

<p>Keep in mind that this was 10 years ago. We had not done anything special except trying to apply eXtreme Programming. Nowadays, as Continuous Integration has become mainstream these skills are becoming more common. That said, we still need to learn how to apply incremental software development to large scale refactoring. This is what I&rsquo;m going to write about today.</p>

<p>This is the seventh post in a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t, I encourage you to start from <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a>.</p>

<h2>Team TDD Coding Dojos</h2>

<p>Learning to work in baby steps is not as complicated as it might first seem. The safest and easiest way is to setup a <a href="/blog/categories/team-randori-series/">team TDD coding dojo</a>. With its Red-Green-Refactor loop TDD sets up a baby steps rhythm. As I&rsquo;ll explain in <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/">my next post</a>, baby steps work best when all the team uses them. That&rsquo;s another thing the team Coding Dojo helps with.</p>

<blockquote><p>üí° TDD has a baby steps rhythm baked in.</p></blockquote>

<p>We can push the learning further. For example, we can use the <a href="http://kata-log.rocks/baby-steps">baby steps constraint</a> during a few coding dojo sessions. With this constraint, we revert the code if tests fail for more than 2 minutes ! Here is a way to go at it :</p>

<ol>
<li>Setup <a href="https://www.amazon.com/Continuous-Testing-Ruby-Rails-JavaScript/dp/1934356700/ref=sr_1_4?ie=UTF8&amp;qid=1533638529&amp;sr=8-4&amp;keywords=continuous+testing">continuous testing</a> : <a href="https://www.ncrunch.net/">NCrunch</a> in <a href="https://www.microsoft.com/net">.Net</a>, <a href="https://github.com/guard/guard">Guard</a> in <a href="https://www.ruby-lang.org/fr/">Ruby</a> or <a href="http://infinitest.github.io/">Infinitest</a> in <a href="https://en.wikipedia.org/wiki/Java_(programming_language">Java</a>)</li>
<li>Only use automated refactorings or extremely simple code changes in order to &hellip;.</li>
<li>&hellip; keep the code compiling all the time &hellip;</li>
<li>&hellip; and cut the time the tests fail as much as possible</li>
</ol>


<h2>Mikado Method</h2>

<p>One way to keep the tests green all the time is to use a slightly different TDD loop, as <a href="http://natpryce.com/articles/000780.html">Nat Pryce suggests</a> :</p>

<p><a href="http://natpryce.com/articles/000780.html"><img src="http://philippe.bourgau.net/imgs/2018-08-07-incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/listening-to-the-tests.png" alt="The red-green-refactor loop of TDD with an extra green arrow from failing test to refactor. This alternate TDD loop illustrates how to take baby steps with the Mikado Method" /></a></p>

<div class="image-credits">From <a href="http://natpryce.com">Nat Pryce's</a> <a href="http://natpryce.com/articles/000780.html">blog</a></div>


<br>


<p>Here is how it goes.¬†</p>

<ol>
<li>Add a new failing test¬†</li>
<li>If it&rsquo;s trivial to fix, fix it. We are done</li>
<li>If not, see what&rsquo;s missing in the code</li>
<li>Comment the test to get back to a green state</li>
<li>Refactor the code to add what&rsquo;s missing (and use other tests if needed)</li>
<li>Uncomment the test</li>
<li>Repeat from step 2</li>
</ol>


<p>When doing this at the scale of a real life story or feature, we&rsquo;d use <code>git stash</code> instead of comments. This way of working has a name, it&rsquo;s called the <a href="https://mikadomethod.wordpress.com/">Mikado Method</a>. It is at the heart of making baby steps work in real life.</p>

<blockquote><p>üí° The Mikado Method is at the heart of making baby steps work in real life</p></blockquote>

<h2>Take a break</h2>

<p>With TDD and the Mikado Method we can put the refactoring on pause. We can perform a small increment of the refactoring, commit and deploy it &hellip; and pause ! We&rsquo;ll work on business features for a while, and resume the refactoring later on.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-07-incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/coffee-break.jpg" alt="A cup of coffee next to a computer. Developers can pause their large scale refactoring if they work in small enough baby steps" /></p>

<p>When done well, it feels slow. We have to remember that the alternative is to convince business people of prioritizing a refactoring &hellip; As we&rsquo;ll regularly ship baby steps of a large scale refactoring, we&rsquo;ll know we&rsquo;re on the good track !</p>

<h2>More to come</h2>

<p>Unfortunately, even with bandwidth and skills, we are not there yet &hellip; It&rsquo;s one thing for developers to do incremental software development of large scale refactoring on their own. It&rsquo;s another to do it as a team !</p>

<p>This was the seventh post in a <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">series about how to get sponsorship for large scale refactoring</a>. <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-3-manage-it/">Next post</a> will be about how to manage constant merciless refactoring and baby steps as a team.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Incremental Software Development Strategies for Large Scale Refactoring #1 : Constant Merciless Refactoring]]></title>
    <link href="http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/"/>
    <updated>2018-08-02T08:31:00+02:00</updated>
    <id>http://philippe.bourgau.net/incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring</id>
    <content type="html"><![CDATA[<p><a href="/incremental-software-development-techniques-for-large-scale-refactorings/">My previous post</a> advocated incremental software development for large scale refactorings. It&rsquo;s less risky and it prevents tunnel effects. Most of all, it&rsquo;s a lot easier to convince business people of engaging in a refactoring this way.</p>

<p>It&rsquo;s one thing to understand why it&rsquo;s the way to go, but it&rsquo;s another to be able to do it ! In this post, I&rsquo;ll start by explaining how to find the time to do constant <a href="http://www.extremeprogramming.org/rules/refactor.html">merciless refactoring</a>.</p>

<p>This is the sixth post in <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">a series about how to get sponsorship for large scale refactoring</a>. If you haven&rsquo;t, I encourage you to start from <a href="/how-to-convince-your-business-to-sponsor-a-large-scale-refactoring/">the beginning</a>.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-02-incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/recurring-cleanup.jpg" alt="Constant Merciless Refactoring illustrated as a recurring cleanup activity" /></p>

<h2><del>Steal</del> Take the time for constant merciless refactoring</h2>

<blockquote><p>If it hurts, do it more often ! <a href="https://martinfowler.com/bliki/FrequencyReducesDifficulty.html">Wisdom of the internet</a></p></blockquote>

<p>As a child, I used to be a very untidy kid. Every few week, my room would get in a real mess, and my mum would order me to clean all this mess. I would then lose 1 or 2 hours tidying my room up. She used to tell me that if I kept things tidy as I used them, I would not have to lose this time. From the top of my 10 years old, I would judge this advice as nonsense.¬†</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-02-incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/messy-bedroom.jpg" alt="This is the kind of mess my bedroom used to be in, when I was a kid, before I learned the virtues of constant merciless refactoring" /></p>

<p>Fast forward a few years, I am myself a parent and I&rsquo;ve been working with legacy code for many years. These years have taught me how much I was wrong &hellip;</p>

<blockquote><p>üí° The easiest refactorings to negotiate are the ones we don&rsquo;t have to talk about !</p></blockquote>

<p>The more refactoring we embed in &lsquo;Business As Usual&rsquo;, the more we&rsquo;ll do, and the less we&rsquo;ll argue with the business. We can wonder if this is still &lsquo;professional&rsquo; ? In <a href="https://www.amazon.com/Art-Agile-Development-Pragmatic-Software/dp/0596527675/ref=sr_1_1?ie=UTF8&amp;qid=1533190334&amp;sr=8-1&amp;keywords=the+art+of+agile">The Art Of Agile Development</a>, <a href="http://www.jamesshore.com/">James Shore</a> explains that managing technical debt is the key to long term productivity. (Details in the <a href="http://www.jamesshore.com/Agile-Book/risk_management.html">Risk Management section of his book</a>). As developers, <em>we</em> are the only experts in the code, the responsibility to keep it clean falls on us.</p>

<blockquote><p>Never ask the permission to do a good job ! <a href="http://docondev.com/">Doc Norton</a></p></blockquote>

<p>There&rsquo;s more to constant merciless refactoring ! It also keeps us in a good position to accept new features or refactorings later down the road.</p>

<p>Following are the 3 practices that make up constant merciless refactoring.</p>

<h2>Yesterday&rsquo;s weather and slack time</h2>

<p>20 years ago, a promises of agile software development was to stick to a <a href="http://www.sustainablepace.net/what-is-sustainable-pace">sustainable pace</a>. When we are working with a flavor of <a href="https://www.scrum.org/">Scrum</a>, we can rely on it&rsquo;s literature to inject some <a href="http://www.jamesshore.com/Agile-Book/slack.html">slack time</a>. ¬†Slack time is buffer time at the end of every iteration. We should not plan any work during the slack, to accommodate with the unexpected. It&rsquo;s a way to deliver on forecasts, whatever happens.</p>

<p>In short, if your velocity chart looks something like that :</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-02-incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/velocity.jpg" alt="Drawing of a fluctuating team velocity. This is often the result of not enough constant merciless refactoring" /></p>

<p>Scrum tells us to plan what you delivered in your worst iteration for the next one ! When things will work bad, we&rsquo;re still pretty likely to deliver what we wanted. When things work well, we&rsquo;ll have time to tackle refactoring.</p>

<p>There&rsquo;s a lot more to say about slack time. How to take some when you are using <a href="https://en.wikipedia.org/wiki/Kanban">Kanban</a> ? How to make sure you keep some when your velocity becomes pretty stable ? How to do you increase your velocity in the long term ? (I guess I&rsquo;ll have to write a full blog post about this some day.)</p>

<h2>The Boy Scout Rule</h2>

<p>I already blogged about the <a href="http://www.informit.com/articles/article.aspx?p=1235624&amp;seqNum=6">Boy Scout Rule</a>. Here is how <a href="https://blog.cleancoder.com/">Uncle Bob</a> wrote it :</p>

<blockquote><p>Always leave the file you are editing a little better than you found it. Bob Martin</p></blockquote>

<p>Following this simple rule goes a long way to keep the code clean and ready for larger refactorings. It works arm in arm with Yesterday&rsquo;s weather principle. The extra time we take for clean up impacts our capacity to plan stories and features. This creates time to keep on doing the boy scout rule in future iterations.</p>

<p>How &lsquo;clean&rsquo; the code should be is a team decision. Coding conventions and a static code analyzer are very important to track the boy scout rule. I learned that code reviews, pairing, mobbing and <a href="/blog/categories/team-randori-series/">coding dojos</a> are great to agree on coding conventions.</p>

<h2>Embedding refactoring in features</h2>

<p>The Test Driven Development loop goes as Red-Green-Refactor.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-02-incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/red-green-refactor.jpg" alt="TDD's Red-Green-Refactor loop. Itself highlighting Constant Merciless Refactoring as a recurring activity" /></p>

<p>The same loop goes on at larger scale for Acceptance or Feature Test. When repeated many times, the loop could as well be Refactor &ndash; Red &ndash; Green. In fact, it&rsquo;s a lot easier to refactor when you know what feature you want to build than at the end of the previous one. (Nat Pryce <a href="http://natpryce.com/articles/000780.html">wrote about that</a> in more details)</p>

<blockquote><p>üí° &ldquo;Disguise&rdquo; refactoring as first technical sub tasks of features to get them prioritized.</p></blockquote>

<p>All this to say, we should start our features with the pre-requisite refactoring ! We should not build features on shaky foundations. We should also impact our estimates. In fact, it&rsquo;s a lot easier to justify to business people at that moment. We don&rsquo;t need to mention &lsquo;refactoring&rsquo; or &lsquo;clean up&rsquo;. We can use technical sub-tasks to track these technical refactorings. Technical sub-tasks are the team&rsquo;s and don&rsquo;t need to be understandable by business people.</p>

<p><img src="http://philippe.bourgau.net/imgs/2018-08-02-incremental-software-development-strategies-for-large-scale-refactoring-number-1-constant-merciless-refactoring/tech-tasks-sea-level.jpg" alt="Technical tasks drawn &quot;Under the sea&quot; and visible to devs only. This leaves them room to do constant merciless refactoring" /></p>

<h2>To be continued</h2>

<p>Finding the time for constant merciless refactoring is one thing, but how do we fit the work in these short slots ? In the <a href="/incremental-software-development-strategies-for-large-scale-refactoring-number-2-baby-steps/">next post</a>, I&rsquo;ll continue about how to actually work in baby steps.</p>

<p>This was the sixth post about <a href="/blog/categories/large-scale-refactoring-sponsorship-series/">how to get sponsorship for large scale refactoring</a>.</p>
]]></content>
  </entry>
  
</feed>
